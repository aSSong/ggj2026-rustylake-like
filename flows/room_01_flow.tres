[gd_resource type="Resource" script_class="FlowGraph" format=3 uid="uid://c5q1t6c1e8x0w"]

[ext_resource type="Script" path="res://scripts/flow/FlowGraph.gd" id="1_kc6xj"]
[ext_resource type="Script" path="res://scripts/flow/FlowStep.gd" id="2_6x0j1"]
[ext_resource type="Script" path="res://scripts/flow/FlowAction.gd" id="3_qbq4o"]

[sub_resource type="Resource" id="Resource_StartOP01"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "op_01_start"
flag_value = true

[sub_resource type="Resource" id="Resource_StartDelayAfterHS02"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "delay_after_hs02_start"
flag_value = true

[sub_resource type="Resource" id="Resource_StartED01"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "ed_01_start"
flag_value = true

[sub_resource type="Resource" id="Resource_EnableHS01"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "flow_hs01_enabled"
flag_value = true

[sub_resource type="Resource" id="Resource_DisableHS01"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "flow_hs01_enabled"
flag_value = false

[sub_resource type="Resource" id="Resource_EnableHS02"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "flow_hs02_enabled"
flag_value = true

[sub_resource type="Resource" id="Resource_DisableHS02"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "flow_hs02_enabled"
flag_value = false

[sub_resource type="Resource" id="Resource_SetCompleted"]
script = ExtResource("3_qbq4o")
type = 0
flag_name = "game_completed"
flag_value = true

[sub_resource type="Resource" id="Resource_StepOP01"]
script = ExtResource("2_6x0j1")
step_id = "Step_OP01"
thread_id = "room_01"
description = "进入房间播放 op_01（设置 op_01_start，等待 op_01_done）"
on_enter_actions = Array[Resource]([SubResource("Resource_StartOP01")])
complete_flags_all = PackedStringArray("op_01_done")
next_ids = PackedStringArray("Step_HS01")

[sub_resource type="Resource" id="Resource_StepHS01"]
script = ExtResource("2_6x0j1")
step_id = "Step_HS01"
thread_id = "room_01"
description = "解锁 HS_01，等待点击完成（hs_01_done）"
on_enter_actions = Array[Resource]([SubResource("Resource_EnableHS01")])
enable_flags_all = PackedStringArray("Step_OP01_completed")
complete_flags_all = PackedStringArray("hs_01_done")
on_complete_actions = Array[Resource]([SubResource("Resource_DisableHS01")])
next_ids = PackedStringArray("Step_HS02")

[sub_resource type="Resource" id="Resource_StepHS02"]
script = ExtResource("2_6x0j1")
step_id = "Step_HS02"
thread_id = "room_01"
description = "解锁 HS_02，等待点击完成（hs_02_done）"
on_enter_actions = Array[Resource]([SubResource("Resource_EnableHS02")])
enable_flags_all = PackedStringArray("Step_HS01_completed")
complete_flags_all = PackedStringArray("hs_02_done")
on_complete_actions = Array[Resource]([SubResource("Resource_DisableHS02")])
next_ids = PackedStringArray("Step_DelayAfterHS02")

[sub_resource type="Resource" id="Resource_StepDelayAfterHS02"]
script = ExtResource("2_6x0j1")
step_id = "Step_DelayAfterHS02"
thread_id = "room_01"
description = "延迟 1 秒后进入 ed_01（设置 delay_after_hs02_start，等待 delay_after_hs02_done）"
enable_flags_all = PackedStringArray("Step_HS02_completed")
on_enter_actions = Array[Resource]([SubResource("Resource_StartDelayAfterHS02")])
complete_flags_all = PackedStringArray("delay_after_hs02_done")
next_ids = PackedStringArray("Step_ED01")

[sub_resource type="Resource" id="Resource_StepED01"]
script = ExtResource("2_6x0j1")
step_id = "Step_ED01"
thread_id = "room_01"
description = "播放 ed_01（设置 ed_01_start，等待 ed_01_done）"
enable_flags_all = PackedStringArray("Step_DelayAfterHS02_completed")
on_enter_actions = Array[Resource]([SubResource("Resource_StartED01")])
complete_flags_all = PackedStringArray("ed_01_done")
next_ids = PackedStringArray("End")

[sub_resource type="Resource" id="Resource_End"]
script = ExtResource("2_6x0j1")
step_id = "End"
thread_id = "room_01"
description = "房间通关：设置 game_completed"
enable_flags_all = PackedStringArray("Step_ED01_completed")
complete_flags_all = PackedStringArray("game_completed")
on_enter_actions = Array[Resource]([SubResource("Resource_SetCompleted")])

[resource]
script = ExtResource("1_kc6xj")
graph_id = "room_01_flow"
start_step_ids = PackedStringArray("Step_OP01")
steps = Array[Resource]([
SubResource("Resource_StepOP01"),
SubResource("Resource_StepHS01"),
SubResource("Resource_StepHS02"),
SubResource("Resource_StepDelayAfterHS02"),
SubResource("Resource_StepED01"),
SubResource("Resource_End")
])

